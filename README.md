# 8. QR-отражений с вращениями

## QR алгоритм в варианте "метода отражений" поиска собственных значений для матриц общего вида, приведение к почти треугольному виду унитарным подобием методом вращений.

### Входные данные должны храниться в формате:
n
a_1_1 a_1_2 ... a_1_n
a_2_1 a_2_2 ... a_2_n
.....................
a_n_1 a_n_2 ... a_n_n

Здесь 
n - размерность матрицы (поле спецификации "%d"),
a_i_j - элементы матрицы (поле спецификации "%lf").

### Формат выходного файла. Если вектор собственных значений найден
n
e_1
e_2
...
e_n

Здесь 
n - размерность матрицы (поле спецификации "%d"), 
e_i - собственные значения, отсортированные в порядке возрастания (поля спецификации "%1.9lf")

### Имена файлов по умолчанию:
34_08_in.txt,
34_08_out.txt

### Запуск с параметрами:
./имя исполняемого файла [имя входного файла] [имя выходного файла] [параметры]
-p выводится расширенная матрица в том же формате, как и во входном файле со значениями матрицы в формате %9.6
-e выводятся ошибки
-t выводится время работы программы
-h, -? справка по формату запуска программы
-prec=<num> точность локализации нуля [значение по умолчанию - 1e-14]
-eps=<num> точность алгоритма
-max_iter=<num> ограничение на число итераций алгоритма (если оно нулевое или отрицательное - ограничений нет)

## Коды возврата:
0 - работа выполнена успешно
-1 - алгоритм не применим к данной матрице
1 - метод не сходится за указанное число итераций
2 - пользователь прервал выполнение программы включением параметра: -h, -?
3 - неизвестный параметр запуска программы
4 - неправильные параметры запуска программы
5 - ошибка открытия выходного файла
6 - ошибка открытия входного файла
7 - ошибка считывания данных

## Алгоритм:
1. Приводим матрицу, поданную на вход к почти треугольному виду методом вращений:
Для этого последовательно умножаем матрицу слева на соответствующую матрицу элементарного вращения, затем умножаем справа на нее же, но транспонированную, обнуляя необходимые элементы.

На приведение матрицы к почти треугольному виду унитарным подобием методом вращений требуется 10/3 * n^3 + O(n^2) мультипликативных операций и 5/3 * n^3 + O(n^2) аддитивных операций

2. Затем к матрице A применяем QR-алгоритм со сдвигами. На шаге k в качестве сдвига sk возьмем ann(k).
Как только на некотором шаге k будет выполнено условие |an,n-1(k)| < ε * ||A||∞ (максимальная строчная норма матрицы), в качестве λn берем ann(k) и применяем алгоритм к подматрице (aij)i,j=1,2,...,n-1 ∈ Mn-1 на 1 меньшей размерности.
Так поступаем до тех пор, пока размерность матрицы не станет равной 2. Для этой матрицы собственные значения определяются как решения соответствующего квадратного уравнения.

Один шаг QR-алгоритма для почти треугольной матрицы для метода отражений требует 5n^2 + O(n) мультипликативных и 3n^2 + O(n) аддитивных операций

Данный итерационный алгоритм не находит комплексные собственные значения матрицы

## в файле main_34_08 определена вспомогательная функция:

int cmp(const void *x, const void *y) - вспомогательная функция сравнения двух элементов для библиотечной функции qsort для сортировки массива чисел типа double
возвращает -1, если первый параметр меньше второго, 1 - первый параметр больше, 0 - параметры равны.